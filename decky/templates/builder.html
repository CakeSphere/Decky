{% extends "layout.html" %}
{% set active_page = "builder" %}
{% block title %}Brew a Deck{% endblock %}
{% block body %}

<div class="container builder">
  <aside class="sidebar">
    <h3>Card Costs</h3>
    <div class="btn-group card-costs">
      <button class="btn w" title="White: 16%" style="width: calc(16.66666667% - 1px)">
        <span class="mana medium sw shadow">&nbsp;</span>
        16%
      </button>
      <button class="btn u" title="Blue: 16%" style="width: calc(16.66666667% - 1px)">
        <span class="mana medium su shadow">&nbsp;</span>
        16%
      </button>
      <button class="btn r" title="Red: 16%" style="width: calc(16.66666667% - 1px)">
        <span class="mana medium sr shadow">&nbsp;</span>
        16%
      </button>
      <button class="btn b" title="Black: 16%" style="width: calc(16.66666667% - 1px)">
        <span class="mana medium sb shadow">&nbsp;</span>
        16%
      </button>
      <button class="btn g" title="Green: 16%" style="width: calc(16.66666667% - 1px)">
        <span class="mana medium sg shadow">&nbsp;</span>
        16%
      </button>
      <button class="btn c" title="Colorless: 16%" style="width: calc(16.66666667% - 1px)">
        <span class="mana medium sc shadow">&nbsp;</span>
        16%
      </button>
    </div>
    <h3>Mana Available</h3>
    <div class="btn-group mana-available">
      <button class="btn w" title="White: 32%" style="width: 32%">
        <span class="mana medium sw shadow">&nbsp;</span>
        32%
      </button>
      <button class="btn u" title="Blue: 34%" style="width: 34%">
        <span class="mana medium su shadow">&nbsp;</span>
        35%
      </button>
      <button class="btn r" title="Red: 32%" style="width: 32%">
        <span class="mana medium sr shadow">&nbsp;</span>
        32%
      </button>
    </div>
    <h3>Legal Formats</h3>
    {% for legality in deck_legality %}
      <button class="btn">{{legality}}</button>
    {% endfor %}
    <h3>Deck Type</h3>
    {% for tag in deck_tags %}
      <button class="btn">{{tag}}</button>
    {% endfor %}
    <h3>Value</h3>
    <a href="http://www.tcgplayer.com" class="btn">
      $ <span class="price">286.27</span>
    </a>
    <span class="price-source">TCGPlayer</span> <br>
    <a href="http://www.isleofcards.com" class="btn">
      $ <span class="price">283.98</span>
    </a>
    <span class="price-source">Isle of Cards</span>
  </aside>
  <section class="content">
    <form>
      <h1>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 24 30" style="enable-background:new 0 0 24 24;" xml:space="preserve"><path d="M13,3c0.828,0,1.5-0.672,1.5-1.5S13.828,0,13,0s-1.5,0.672-1.5,1.5S12.172,3,13,3z M12.5,5c0,0.552,0.448,1,1,1    s1-0.448,1-1s-0.448-1-1-1S12.5,4.448,12.5,5z M10,6c0.828,0,1.5-0.672,1.5-1.5S10.828,3,10,3S8.5,3.672,8.5,4.5S9.172,6,10,6z     M18,21h-0.5v-0.025c1.91-1.622,3-3.968,3-6.475c0-1.762-0.532-3.429-1.537-4.86C19.288,9.365,19.5,8.959,19.5,8.5    C19.5,7.673,18.827,7,18,7H6C5.173,7,4.5,7.673,4.5,8.5c0,0.459,0.211,0.865,0.537,1.14C4.033,11.071,3.5,12.738,3.5,14.5    c0,2.507,1.09,4.854,3,6.475L6,21c-0.827,0-1.5,0.673-1.5,1.5S5.173,24,6,24h2c0.189,0,0.362-0.107,0.447-0.276l0.623-1.245    c1.879,0.692,3.981,0.692,5.86,0l0.623,1.245C15.638,23.893,15.811,24,16,24h2c0.827,0,1.5-0.673,1.5-1.5S18.827,21,18,21z     M6.753,17.457c-0.067,0.031-0.138,0.045-0.208,0.045c-0.189,0-0.371-0.108-0.455-0.292c-0.392-0.854-0.59-1.766-0.59-2.711    c0-0.276,0.224-0.5,0.5-0.5s0.5,0.224,0.5,0.5c0,0.8,0.168,1.572,0.5,2.294C7.115,17.045,7.004,17.342,6.753,17.457z"/></path></svg>
        Brew a Deck
      </h1>
      <h3>Name</h3>
      <input type="text" name="name" value="{{edit_name}}">
      <div class="container columns-2">
        <div class="column">
          <h3>Formats</h3>
          <input type="text" name="formats" value="{{edit_formats}}">
        </div>
        <div class="column">
          <h3>Tags</h3>
          <input type="text" name="tags" value="{{edit_tags}}">
        </div>
      </div>
      <h3>Description</h3>
      <textarea rows="5" name="description" class="description">{{edit_description}}</textarea>
      <h3>Cards</h3>
      <div class="builder-cards">
        <div class="tabs">
          <a href="{{ url_for('builder')}}" data-tab="tab-1" class="btn active">Mainboard</a>
          <a href="{{ url_for('builder')}}" data-tab="tab-2" class="btn">Sideboard</a>
          <a href="{{ url_for('builder')}}" data-tab="tab-3" class="btn">Maybeboard</a>
          <a href="{{ url_for('builder')}}" data-tab="tab-4" class="btn">Acquireboard</a>
          <a href="{{ url_for('builder')}}" data-tab="tab-5" class="btn">Bulk Edit</a>
        </div>
        <div class="tab-1">
          <table class="builder-table">
            <thead>
              <tr>
                <th class="text-right builder-quantity">0</th>
                <th class="desc">Name</th>
                <th>Set</th>
                <th>Type</th>
                <th style="width: 30px">Foil</th>
                <th style="width: 100px">Featured</th>
                <th style="width: 100px">Commander</th>
                <th style="width: 25px">&nbsp;</th>
              </tr>
            </thead>
            <tbody>
              {% if edit_mode %}
                {% for card in edit_cards %}
                <tr class="row-{{card.multiverseid}}">
                  <td class="text-right quantity">{{count[card.multiverseid]}}</td>
                  <td>
                    <a href="/card/{{card.multiverseid}}" target="_blank" class="tooltip" data-img="{{card.multiverseid}}">{{card.name}}</a>
                  </td>
                  <td>
                    <select name="" id="select-set-{{card.multiverseid}}" class="btn">
                      {% for name in edit_card['edit_names'] %}
                        {% if name == card.name %}
                          <option value="edit_card['edit_ids'][loop.index-1]">{{edit_card['edit_sets'][loop.index-1]}}</option>
                        {% endif %}
                      {% endfor %}
                    </select>
                  </td>
                  <td>{{card.type}}</td>
                  <td>
                    <input type="checkbox" id="{{card.multiverseid}}" {% if foil[card.multiverseid] %}checked{% endif %}>
                    <label for="{{card.multiverseid}}"></label>
                  </td>
                  <td>
                    <input type="radio" name="featured" id="{{card.multiverseid}}f" {% if card.multiverseid == edit_featured | int %}checked{% endif %}>
                    <label for="{{card.multiverseid}}f"></label>
                  </td>
                  <td>
                    <input type="radio" name="commander" id="{{card.multiverseid}}c" {% if commander[card.multiverseid] %}checked{% endif %}>
                    <label for="{{card.multiverseid}}c"></label>
                  </td>
                  <td class="text-center">
                    <a href="" class="delete-card">
                      <svg class="cancel" xmlns="http://www.w3.org/2000/svg"x="0px" y="0px" viewBox="0 0 823.93427 1029.8962375"><title>Cancel</title><path d="m 776.75678,0 c -12.064,0 -24.124,4.608 -33.345,13.828 L 411.94378,345.27301 80.52575,13.879 c -18.443,-18.441 -48.255,-18.441 -66.695,0 -18.441,18.44 -18.441,48.244 0,66.685 l 331.418,331.39601 -331.418,331.399 c -18.441,18.44 -18.441,48.25 0,66.691 9.198,9.198 21.272,13.817 33.347,13.817 12.073,0 24.15,-4.619 33.348,-13.817 l 331.41803,-331.398 331.468,331.445 c 9.197,9.198 21.271,13.82 33.345,13.82 12.074,0 24.101,-4.622 33.346,-13.82 18.442,-18.441 18.442,-48.247 0,-66.687 l -331.464,-331.446 331.464,-331.44501 c 18.442,-18.441 18.442,-48.25 0,-66.691 C 800.88178,4.608 788.81678,0 776.75678,0 Z"/></svg>
                    </a>
                  </td>
                </tr>
                {% endfor %}
              {% endif %}
            </tbody>
          </table>
          <div class="add-card">
            <!-- Quantity -->
            <input class="card-quantity" type="number" value="1" max="99" min="1">
            <!-- Name -->
            <input type="text" class="card-name" placeholder="Card name&hellip;" list="cardNames">
            <a href="{{ url_for('builder')}}" class="btn">Advanced Search</a>
            <button class="btn add-row">Add</button>
          </div>
        </div>
        <div class="tab-2">
          <table class="builder-table">
            <thead>
              <tr>
                <th class="text-right">0</th>
                <th class="desc">Name</th>
                <th>Set</th>
                <th>Type</th>
                <th style="width: 30px">Foil</th>
                <th style="width: 100px">Featured</th>
                <th style="width: 100px">Commander</th>
              </tr>
            </thead>
          </table>
          <div class="add-card">
            <!-- Quantity -->
            <input class="card-quantity" type="number" value="1" max="99" min="1">
            <!-- Name -->
            <input type="text" class="card-name" placeholder="Card name&hellip;" list="cardNames">
            <a href="{{ url_for('builder')}}" class="btn">Advanced Search</a>
            <button class="btn add-row">Add</button>
          </div>
        </div>
        <div class="tab-3">
          <table class="builder-table">
            <thead>
              <tr>
                <th class="text-right">0</th>
                <th class="desc">Name</th>
                <th>Set</th>
                <th>Type</th>
                <th style="width: 30px">Foil</th>
                <th style="width: 100px">Featured</th>
                <th style="width: 100px">Commander</th>
              </tr>
            </thead>
          </table>
          <div class="add-card">
            <!-- Quantity -->
            <input class="card-quantity" type="number" value="1" max="99" min="1">
            <!-- Name -->
            <input type="text" class="card-name" placeholder="Card name&hellip;" list="cardNames">
            <a href="{{ url_for('builder')}}" class="btn">Advanced Search</a>
            <button class="btn add-row">Add</button>
          </div>
        </div>
        <div class="tab-4">
          <table class="builder-table">
            <thead>
              <tr>
                <th class="text-right">0</th>
                <th class="desc">Name</th>
                <th>Set</th>
                <th>Type</th>
                <th style="width: 30px">Foil</th>
                <th style="width: 100px">Featured</th>
                <th style="width: 100px">Commander</th>
              </tr>
            </thead>
          </table>
          <div class="add-card">
            <!-- Quantity -->
            <input class="card-quantity" type="number" value="1" max="99" min="1">
            <!-- Name -->
            <input type="text" class="card-name" placeholder="Card name&hellip;" list="cardNames">
            <a href="{{ url_for('builder')}}" class="btn">Advanced Search</a>
            <button class="btn add-row">Add</button>
          </div>
        </div>
        <div class="tab-5">
          <textarea name="" id="" cols="30" rows="20" class="bulk-edit">
4x Aether Hub
4x Inspiring Vantage
2x Island
4x Plains
3x Port Town
4x Spirebluff Canal
4x Wandering Fumarole
8x Fevered Visions
4x Reflector Mage
4x Selfless Spirit
4x Spell Queller
4x Galvanic Bombardment
4x Immolating Glare
2x Chandra, Torch of Defiance
2x Gideon, Ally of Zendikar
4x Incendiary Flow</textarea>
        </div>
      </div>
      <p>
        <button class="btn primary save-deck" type="submit">Save Changes</button>
        <a href="{{ url_for('builder')}}" class="btn">Revert</a>
      </p>
    </form>
  </section>
</div>
<datalist id="cardNames">
  <option value="Selfless Spirit">
  <option value="Spell Queller">
  <option value="Spirebluff Canal">
</datalist>
  {% if edit_mode %}
    <script>
      var edit_deck = {
        'totalQuantity': 0,
        cards: {},
        edit_id: {{edit_id}}
      }
    </script>
    {% for card in edit_cards %}
      <script>
        edit_deck.cards['{{card.multiverseid}}'] = {
          "quantity": {{count[card.multiverseid]}},
          "foil": false,
          "featured": false,
          "commander": false
        };
        edit_deck['totalQuantity'] = edit_deck['totalQuantity'] + edit_deck.cards['{{card.multiverseid}}'].quantity
      </script>
    {% endfor %}
  {% endif %}
{% endblock %}
